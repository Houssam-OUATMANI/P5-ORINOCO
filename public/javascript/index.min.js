const cardHolder=document.querySelector(".card__holder"),counter=document.querySelector(".counter"),outerLoader=document.querySelector(".loader__outer");let panier=[];async function fetchData(){outerLoader.style.visibility="visible";try{const t="http://localhost:3000/api/cameras",e=await fetch(t);return await e.json()}catch(t){throw new Error(`Well something wrong happend\n ${t}`)}}function display(t){outerLoader.style.display="none",t.map(t=>{cardHolder.innerHTML+=`\n        <article class="card">\n        <a href="./appareil.html?id=${t._id}">\n            <div class="card__img">\n                <img src="${t.imageUrl}" alt="${t.name}">\n            </div>\n        </a>\n            <div class="card__info">\n                    <h3>${t.name}</h3>\n                <p>Prix <strong>${t.price/100} $</strong></p>\n            </div>\n            <button class="panier-btn" data-id="${t._id}">Ajouter au panier</button>\n            <a class="detail" href="./appareil.html?id=${t._id}">Details</a>\n        </article>\n        `})}function getButtons(){[...document.querySelectorAll(".panier-btn")].map(t=>{const e=t.dataset.id;JSON.parse(localStorage.getItem("paniers")).find(t=>t._id===e)?(t.innerHTML="Ajouté au panier !",t.disabled=!0,t.classList.add("disabled")):t.addEventListener("click",()=>{t.innerHTML="Ajouté au panier",t.disabled=!0,t.classList.add("disabled");const a={...Storage.getproducts(e),count:1,added:!0};panier=[...JSON.parse(localStorage.getItem("paniers")),a],Storage.saveCart(panier),setItemValues(panier)})})}function setItemValues(t){let e=0,a=0;t.map(t=>{e+=t.price*t.count/100,a+=t.count}),counter.innerHTML=a,Storage.storeTotalItem(a),Storage.storeTotalPrice(e)}function setTotalItems(){counter.innerHTML=Storage.getTotalPrice()}class Storage{static saveProducts(t){localStorage.setItem("cameras",JSON.stringify(t))}static getproducts(t){return JSON.parse(localStorage.getItem("cameras")).find(e=>e._id===t)}static saveCart(t){localStorage.setItem("paniers",JSON.stringify(t))}static storeTotalItem(t){localStorage.setItem("totalItem",JSON.stringify(t))}static storeTotalPrice(t){localStorage.setItem("totalPrice",JSON.stringify(t))}static getTotalPrice(){return localStorage.getItem("totalItem")?JSON.parse(localStorage.getItem("totalItem")):0}}document.addEventListener("DOMContentLoaded",()=>{localStorage.getItem("paniers")||localStorage.setItem("paniers",JSON.stringify([])),fetchData().then(t=>{display(t),Storage.saveProducts(t)}).then(()=>{getButtons(),setTotalItems()})});