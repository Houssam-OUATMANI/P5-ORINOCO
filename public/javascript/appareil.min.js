const cardHolder=document.querySelector(".card__holder"),counter=document.querySelector(".counter"),outerLoader=document.querySelector(".loader__outer"),lensesContainer=document.querySelector(".lenses__container");outerLoader.style.visibility="visible";const fetchOne=async()=>{const e=`http://localhost:3000/api/cameras/${new URLSearchParams(window.location.search).get("id")}`;try{const t=await fetch(e),n=await t.json(),{name:a,description:r,imageUrl:o,price:i,lenses:c,_id:l}=n;outerLoader.style.display="none",cardHolder.innerHTML=`\n        <article class="card">\n            <div class="card__img">\n                <img src="${o}" alt="${a}">\n            </div>\n            <div class="card__info">\n                 <h3>${a}</h3>\n                <p>Prix <strong>${i/100}$</strong> </p>\n                \n            </div>\n            <div>\n                <p>${r}</p>\n            <div>\n            <button class= "panier-btn" data-id=${l} data-price =${i/100}>Ajouter au panier</button>\n            \n            </article>\n            `,c.forEach(e=>{lensesContainer.innerHTML+=`\n                <input type="checkbox" name="${e}" value="${e}"> \n                <label>${e}</label><br>\n                `})}catch(e){throw new Error(`Well something wrong happend\n ${e}`)}};function getButton(){const e=document.querySelector(".panier-btn"),t=e.dataset.id,n=JSON.parse(localStorage.getItem("paniers"));let a;null!==n&&(a=n.find(e=>e._id===t)),a?(e.innerHTML="Ajouté au panier !",e.disabled=!0):e.addEventListener("click",()=>{e.innerHTML="Ajouté au panier !",e.disabled=!0;let n=+e.dataset.price;console.log(n);let a={...Storage.getproducts(t),count:1,added:!0};panier=[...JSON.parse(localStorage.getItem("paniers")),a],Storage.saveCart(panier);let r=JSON.parse(localStorage.getItem("totalItem")),o=JSON.parse(localStorage.getItem("totalPrice"));o+=n,r+=1,localStorage.setItem("totalItem",JSON.stringify(r)),localStorage.setItem("totalPrice",JSON.stringify(o)),counter.innerHTML=+counter.innerHTML+1})}function setTotalItem(){let e=localStorage.getItem("totalItem");return e&&(counter.innerHTML=e),e}class Storage{static getproducts(e){return JSON.parse(localStorage.getItem("cameras")).find(t=>t._id===e)}static saveCart(e){const t=JSON.stringify(e);localStorage.setItem("paniers",t)}}document.addEventListener("DOMContentLoaded",()=>{localStorage.getItem("paniers")||localStorage.setItem("paniers",JSON.stringify([])),fetchOne().then(()=>{setTotalItem(),getButton()})});